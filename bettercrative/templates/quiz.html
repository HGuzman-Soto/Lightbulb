{% extends "layout.html" %}
{% block content %}

<style>
    body {
        background-image: none;
    }

    section.nav-section {
        background-color: rgb(188, 252, 231)
    }

    .affix {
        padding: 0;
        font-size: 80%;
        background-color: rgb(188, 252, 231);
    }

    .affix .container .logo a {
        color: black;
        font-size: 100%;
    }

    .affix .container .navlinks a {
        color: black;
    }

    .nav .affix .navTrigger i {
        font-size: 80%;
        color: black;
    }

    .affix .navTrigger i {
        background-color: black;
    }

    .affix .navTrigger p {
        color: black;
    }
</style>

<div id="quiz-content-container">
    <!-- Quiz Edit Container for users -->
    <div id="editing-container">
        <!--  want to change this later to classroom name  -->
            <div class="headerSection">
                <div class="btn QuizSaveExitBtn"><a href="{{ url_for('main.home') }}">Save and Exit</a></div>
            </div>

        <!-- Quiz Title -->
        <div id="quiz-title">
            <span class="btn editTitle" id="quizname" onclick="showEditQuizNameContainer()">
                {{quiz.name}}
                <span style="margin:.5vw; float:right; opacity:0.5; font-size:2vw;">
                    <i class="fas fa-pencil-alt"></i>
                </span>
            </span>
	        <!-- Quiz name edit form -->
            <form style="display: none;" id="quiz-name-edit-form"
                  action="{{ url_for('quizzes.edit_quiz_name', quiz_id=quiz.id) }}">
                {{ qzform.hidden_tag() }}
                {{ qzform.name(value=quiz.name) }}
                <!-- This area will hold the save and edit stuff, this is what changes when the input is clicked into -->
                <span>

                </span>
                {{ qzform.submit(class="btn btn-outline-info", value="Save") }} 
                <span style="margin-right: .5vw;" class="btn btn-outline-secondary"
                        onclick="refresh('#body')">
                        Cancel
                </span>
            </form>
            {% if qzform.errors %}
            {{ qzform.errors }}
            {% endif %}
        </div>

        <!-- Sets the nav bar for the questions, add scrolling later.  format so it is all in one row -->
        <div class="scrollmenu .all-items .slides">
            {% for question in quiz.questions %}
            <a class="btn item {% if quiz.active == question.id %} activeQuestion {% endif %}"
               id="qbtn-{{ loop.index }}"
               onclick="change_active_question('{{ url_for('quizzes.change_active_question') }}', question_id={{ question.id }}, quiz_id={{ quiz.id }})">
                {% if not loop.first %}
                <button class="btn btn-outline-info shift-Button"
                        onclick="shiftQuestion('{{ url_for('quizzes.shift_question') }}', q_id={{ question.id }}, direction='left')">
                    <i class="fa fa-arrow-left"></i>
                </button>
                {% endif %}
                ID: {{question.id}}
                <button class="btn btn-outline-danger Remove-Button"
                        onclick="removeQuestion('{{ url_for('quizzes.remove_question') }}', q_id={{ question.id }})">
                    <i class="fa fa-times fa-2x"></i>
                </button>
                {% if not loop.last %}
                <button class="btn btn-outline-info shift-Button"
                        onclick="shiftQuestion('{{ url_for('quizzes.shift_question') }}', q_id={{ question.id }}, direction='right')">
                    <i class="fa fa-arrow-right"></i>
                </button>
                {% endif %}
            </a>
            {% endfor %}

            <button class="btn btn-outline-success .item .slide"
                    onclick="addQuestion('{{ url_for('quizzes.add_question') }}', q_id={{ quiz.id }})">
                <i class="fa fa-plus"></i>
            </button>
        </div>

        <!-- prevent things from floating after this section -->
        <div style=" clear: both;"></div>
        <!-- prevent things from floating after this section -->

        <div id="questions">
            {% for question in quiz.questions %}
            <div id="question-{{ loop.index }}" {% if quiz.active != question.id %} style="display: none;" {% endif %}>
                {% if question.category %}
                {{ question.category }}
                <div id="question">
                    <div class='question-container'>
                        <!-- Multiple Choice -->
                        {% if question.category == 'Multiple Choice' %}
                        <div class='multiple-choice'>
                            <!-- contents of multiple choice box -->
                        <div class="question-edit-header">
                            <div class="question-number">
                                <!-- set form -->
                                <span id="question-content-display-{{ question.id }}">
                                    <label>{{ question.name }}) {{ question.content }}</label>
                                    <span class="btn btn-sm btn-outline-info"
                                          onclick="showEditQuestionContainer(index={{question.id}})"><i class="fas fa-pencil-alt"></i></span>
                                </span>
                                <form style="display: none;" id="question-content-edit-form-{{ question.id }}"
                                      action="{{ url_for('quizzes.edit_question', question_id=question.id) }}"
                                      method="POST">
                                    {{ form.hidden_tag() }}
                                    {{ form.question_form.hidden_tag() }}
                                    <fieldset class="form-group">
                                        <label>{{ question.name }})
                                            {{ form.question_form.content(value=question.content) }}</label>
                                        <span>
                                            {{ form.submit(class="btn btn-sm btn-outline-info") }}
                                        </span>
                                        <span class="btn btn-sm btn-outline-info"
                                              onclick="refresh('#body')">Cancel</span>
                                        <div id="displayAnswerEdit-{{ question.id }}" class="form-group">
                                        {% for answer in question.answers %}
                                            {{ append_form(form) }}
                                            {% set aform = form.answer_form[ loop.index0 ] %}
                                            {{ aform.hidden_tag() }}
                                            <div class="correctness-container">
                                                    {{ aform.content(value=answer.content) }}
                                                    {% if answer.correct %}
                                                        <i id="answer_form-{{ loop.index0 }}-checkbox" class="fas fa-check-circle"></i>
                                                        {{ aform.correct(checked=True, value='y', class_="actual-checkbox") }}
                                                    {% else %}
                                                        <i id="answer_form-{{ loop.index0 }}-checkbox" class="far fa-check-circle"></i>
                                                        {{ aform.correct(checked=False, value='n', class_="actual-checkbox") }}
                                                    {% endif %}
                                                </div>
                                        {% endfor %}
                                        </div>
                                    </fieldset>
                                </form>
                                {% if form.errors %}
                                {{ form.errors }}
                                {% endif %}
                            </div>
                        </div>
                            <div class="answerchoices">
                                <span class="menu">
                                    
                                    <!-- prevent things from floating after this section -->
                                    <span style=" clear: both;"></span>
                                    <!-- prevent things from floating after this section -->

                                </span>
                            </div>
                            <span class="reset"> </span>
                            <div class="answerContainer reset">
                                {% set outer_loop = loop %}
                                <!-- This area is for the set answers -->
                                <div id="displayAnswer-{{ question.id }}">
                                    {% for answer in question.answers %}
                                    <div class="answerChoice">
                                        <span class="btn btn-secondary active button-choices">{{ get_alphabet_index(loop.index) }}</span>
                                        <div class="answerBox">
                                            <span class="content-section">
                                                <button class="btn btn-sm btn-outline-danger answer-delete-button"
                                                        onclick="removeAnswer('{{ url_for('quizzes.remove_answer') }}', a_id={{ answer.id }})">
                                                    <i class="fa fa-times fa-lg"></i>
                                                </button>
                                                <span id="answer-content-display-{{ answer.id }}">
                                                    <label class="answer-content">{{ answer.content }}{% if answer.correct %}(Correct){% endif %}</label>
                                                </span>
                                            </span>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                <button class="btn btn-outline-success"
                                        onclick="addAnswer('{{ url_for('quizzes.add_answer') }}', q_id={{ question.id }})">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </div>
                        </div>

                        <!-- True/False -->
                        {% elif question.category == 'True-False' %}
                        <div class='true-false'>

                            <div class="answerchoices">
                                <span class="menu">
                                    
                                    <!-- prevent things from floating after this section -->
                                    <span style=" clear: both;"></span>
                                    <!-- prevent things from floating after this section -->

                                </span>
                            </div>
                        </div>
                        <span class="reset"></span>
                        <span class="answerContainer reset">
                            {% for answer in question.answers %}
                            <!-- hover on the selected then submit button on save  -->
                            <!-- FORM -->

                            {%if answer.content == "True"%}
                            <span class="btn btn-lg btn-outline-success" id='{{answer.id}}-btn'
                                  onclick='showTrueFalse("{{answer.id}}",choice="true", "{{question.answers}}")'>True</span>
                            {%else%}
                        <span class="btn btn-lg btn-outline-danger" id='{{answer.id}}-btn'
                              onclick='showTrueFalse("{{answer.id}}",choice="false", "{{question.answers}}")'>False</span>

                            {%endif%}
                            
                            {%endfor%}
                            <span class='btn btn-lg btn-outline-primary' id="check_button" onclick='setTrueFalse(this)'
                                  style='display:none;'>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="currentColor"><path fill-rule="nonzero"
                                                               d="M18.293 6.293a1 1 0 011.497 1.32l-.083.094-10 10a1 1 0 01-1.32.083l-.094-.083-5.5-5.5a1 1 0 011.32-1.497l.094.083L9 15.585l9.293-9.292z"></path></svg>
                            </span>
                        </span>


                        <!-- Short Answer -->
                        {% elif question.category == 'Short Answer'%}
                        <div class='short-answer'>
                        </div>

                        <!-- IDE -->
                        {% else %}
                        <div class='IDE'>
                        </div>
                        {%endif%}
                    </div>
                </div>
            </div>
            {% else %}
            <!-- four buttons to choose question type -->
            <div class="question-type-container">
                <button class="question-type-choice-box btn-primary"
                        onclick="setQType('{{ url_for('quizzes.set_question_type') }}',question_id={{ question.id }}, qtype='Multiple Choice')">
                    Multiple
                    Choice
                </button>
                <button class="question-type-choice-box btn-danger"
                        onclick="setQType('{{ url_for('quizzes.set_question_type') }}',question_id={{ question.id }}, qtype='True-False')">
                    True
                    or False
                </button>
                <button class="question-type-choice-box btn-warning"
                        onclick="setQType('{{ url_for('quizzes.set_question_type') }}',question_id={{ question.id }}, qtype='Short Answer')">
                    Short
                    Answer
                </button>
                <button class="question-type-choice-box btn-secondary"
                        onclick="setQType('{{ url_for('quizzes.set_question_type') }}',question_id={{ question.id }}, qtype='IDE')">
                    Coding
                </button>
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>
<script src="{{ url_for('static', filename='js/horizontalscroll.js') }}"></script>
{% endblock %}

