{% extends "layout.html" %}

{% block content %}

<div id="classroom-container">
	{% if current_user.is_authenticated %}
	<div class="titlebar">
		<!-- Classroom Title -->
		<button class="btn-sm editTitle general-btn classroomname" id="classroom-{{classroom.id}}"
		        onclick="showEditClassroom({{classroom.id}})" aria-label="edit classroom name">
			{{ classroom.name }}
			<span style="margin:.5vw; float:right; opacity:0.5; font-size:2vw;">
						<i class="fas fa-pencil-alt" aria-hidden="true"></i>
					</span>
		</button>
		<!-- Title edit form -->
		<form class="editTitle general-btn" id="classroom-form-{{classroom.id}}" style="display: none;"
		      action="{{ url_for('classrooms.edit_classroom_name', classroom_id=classroom.id) }}">
			{{form.hidden_tag()}}
			<fieldset class=" form-group edit-classroom-form">
				<div class="form-group">
					{% if form.name.errors %}
					{{form.name(placeholder='Enter new name '
					,id='classroomname-content-'~classroom.id,value=classroom.name, maxlength='20', class='form-control
					form-control-lg is-invalid editTitle general-btn classroomname')}}
					<div class="invalid-feedback">
						{% for error in form.name.errors %}
						{{ error }}
						{% endfor %}
					</div>
					{% else %}
					{{form.name(placeholder='Enter new name '
					,id='classroomname-content-'~classroom.id,value=classroom.name, maxlength='20', class='form-control
					form-control-lg editTitle general-btn classroomname')}}
					{% endif %}
				</div>
			</fieldset>
			<div class=form-group"> {{form.submitClass(class='btn btn-sm btn-outline-info',
				type='submit',id='submit-classroom-'~classroom.id, value='Save')}}
				<input type="reset" class="btn btn-sm btn-outline-danger" name="Cancel" value="Cancel"
				       onclick="cancelEditClassroom({{classroom.id}})">
			</div>
		</form>
		<!-- Save button -->
		<button class="btn-sm sideClick general-btn"
		        onclick="window.location.href='{{ url_for('users.classrooms') }}';">
			<i class="fas fa-cloud-upload-alt" aria-hidden="true"></i> Save and Exit
		</button>
	</div>
	{% endif %}

	<!-- prevent things from floating after this section -->
	<div style=" clear: both;"></div>
	<!-- prevent things from floating after this section -->

	<!-- List of added quizzes -->
	<div class="quizlist" id="quizzes-{{classroom.id}}">
		<!-- Heading and add-quiz button -->
		<div id="ActiveRoomsHeader" style="font-size: 2.2vw;">
			<h4 class="Active-Rooms">Added Quizzes</h4>
			<button class="btn-sm sideClick general-btn"
			        onclick="window.location.href='{{ url_for('classrooms.add_quiz', classroom_id=classroom.id) }}';"><i
					class="fas fa-plus" aria-hidden="true"></i> Add a Quiz
			</button>
		</div>
		<div style="clear: both;"></div>
		<!-- actual quiz data/options -->
		<div class="account-tables">
			<div class="row table-element header-row">
				<!-- TODO when one of these buttons is clicked, sort the list. -->
				<div class="col-3 text-center show">
					<button id="sort-by-name" class="btn general-btn table-header">Name <i class="fas fa-arrow-up sort-ascending"
					                                                           aria-hidden="true"><span class="sr-only">Sort classrooms by name (descending)</span></i>
					</button>
				</div>
				<div class="col-6 text-center show">
					<button id="sort-by-date" class="btn general-btn table-header">Date Created <i
							class="fas fa-arrow-up sort-ascending" aria-hidden="true"><span class="sr-only">Sort classrooms by date (descending)</span></i>
					</button>
				</div>
				<div class="btn col-3 show table-header options-header">Options</div>
			</div>
			
			{% for quiz in classroom.added_quizzes|sort(attribute="name") %}
			<!-- JavaScript option to set the current quiz in the list to active -->
			
			<div id="quiz-{{ quiz.id }}" class="row table-element">
			
				{%include 'set_active_modal.html'%}
			
				<div class="col-4">{{ quiz.name }}
					{% if quiz.id == classroom.active_quiz %}
					(active)
					{% endif %}
				</div>
				<div class="col-4 text-center date-created" style="padding-left: 3%;">
					{{ quiz.date_created.strftime("%m/%d/%y") }}
				</div>
				{% if quiz.id != classroom.active_quiz %}
				<div class="col-4 quiz-icon-col">

					<button id="set-active-{{classroom.id}}" class="btn general-btn"
					   data-toggle='modal' data-target='#set_active_modal-{{quiz.id}}'>
						Set Active
					</button>
					
					<button onclick="window.location.href='{{ url_for('quizzes.quiz', quiz_id=quiz.id) }}';"
						        type="button" class="btn btn-sm general-btn" aria-label="edit quiz">
							<i class="account-page-icons fas fa-pencil-alt" aria-hidden="true"></i>
					</button>
					<button type="button" class="btn btn-sm general-btn"
						        onclick="removeClassroomPopup('{{ url_for('classrooms.delete_classroom') }}', {{ classroom.id }})"
						        aria-label="delete quiz">
							<i class="account-page-icons fa fa-trash" aria-hidden="true"></i>
					</button>
				</div>

				{% else %}
				<div class="col-4 quiz-icon-col">
					<button id="remove-active-{{classroom.id}}" class="btn general-btn"
				onclick="remove_active({{classroom.id}})">
						Unset Active
					</button>
				</div>
				{% endif %}
			
			</div>
			
			{%endfor%}
		</div>
	</div>
</div>

{% if (current_user.is_authenticated) and (classroom.owner == current_user) %}
<div class="classroom-options">
{% if classroom.active_quiz %}
	<button id="take-active-quiz" class="btn general-btn"
	   onclick="window.location.href='{{ url_for('classrooms.take_quiz', classroom_id=classroom.id) }}';">Take Active Quiz <i class="fas fa-door-open"></i></button>
	{% if has_responses %}
	<button id="view-results" class="btn general-btn"
	   onclick="window.location.href='{{ url_for('classrooms.view_results', classroom_id=classroom.id) }}';"><i class="fas fa-chart-bar" aria-hidden="true"></i> View Results</button>
	{% endif %}
	<div style="clear: both;"></div>
{% endif %}
</div>
{% endif %}
<script src="{{url_for('static', filename='js/set_active.js')}}" type="text/javascript"></script>
{% endblock %}
